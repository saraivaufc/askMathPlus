{% extends 'askmath/forum/forum_home.html' %}
{% load i18n %}
{% load humanize %}

{%  block content %}
{% if perms.askmath.write_category %}
<div class="cell padding10">
		<a href="/forum/categories/add/" class="image-button button-success">
			{% trans "Create" %}
			<span class="icon mif-plus"></span>
		</a>
	{% if is_removed %}
		<a href="/forum/categories/view/" class="image-button button-info" data-popover="undo">
			{% trans "Undo" %}
			<span class="icon mif-undo"></span>
		</a>
	{% else %}
		<a href="/forum/categories/view_removed/" class="image-button button-warning" data-popover="dump">
			{% trans "Dump" %}
			<span class="icon mif-bin"></span>
		</a>
	{% endif %}
</div>
{% endif %}

<div class="padding10">
	<table class="table table-category hovered border">
		<thead>
			<tr>
				<th class="category" >{% trans "Category" %}</th>
				<th class="post" >{% trans "Posts" %}</th>
				<th class="last_post" >{% trans "Last Post" %}</th>
			</tr>
		</thead>
		<tbody>
			{% for category in categories %}
			<tr>
				<td class="category width">
					<div class="icon"></div>
					<div class="details">
						<h4 class="title">
							<a class="fg-dark" href="/forum/categories/view/category={{ category.id }}/">{{ category.get_title }}</a>
						</h4>
						<div class="description">{{ category.get_description }}</div>
					</div>
				</td>
				<td class="post">{{ category.get_topics|length }}</td>
				<td class="last_post">
					{% if category.get_topics|length > 0 %}
						{% with category.get_topics|first as topic  %}
						<a href="/forum/topics/view/category={{ category.id }}/topic={{ topic.id }}/">
							<h5>{{ topic.title }}</h5>
						</a>
						{% blocktrans with creation=topic.creation|naturaltime person=topic.person %}
						<h6>{{ creation }} by {{ person }}.</h6>
						{% endblocktrans %}
						{% endwith %}
					{% else %}
					{% endif %}
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endblock %}
