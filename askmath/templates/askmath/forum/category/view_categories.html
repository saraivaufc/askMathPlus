{% extends 'askmath/forum/forum_home.html' %}
{% load i18n %}
{% load humanize %}

{%  block content %}
<div class="cell padding10">
	{% if perms.askmath.write_category %}
		<a href="/forum/categories/add/" class="image-button button-success">
			{% trans "Create" %}
			<span class="icon mif-plus"></span>
		</a>
	{% if is_removed %}
		<a href="/forum/categories/view/" class="image-button button-info" data-popover="undo">
			{% trans "Undo" %}
			<span class="icon mif-undo"></span>
		</a>
	{% else %}
		<a href="/forum/categories/view_removed/" class="image-button button-warning" data-popover="dump">
			{% trans "Dump" %}
			<span class="icon mif-bin"></span>
		</a>
	{% endif %}
	{% endif %}
</div>

<div class="padding10">
	<table class="table table-category striped hovered border">
		<thead>
			<tr>
				<th>{% trans "Category" %}</th>
				<th>{% trans "Posts" %}</th>
				<th>{% trans "Last Post" %}</th>
			</tr>
		</thead>
		<tbody>
			{% for category in categories %}
			<tr>
				<td class="category">
					<div>
						<span class="icon"></span>
						<h3 class="title">
							<a href="/forum/categories/view/category={{ category.id }}/">{{ category.get_title }}</a>
						</h3>
					</div>
					<p class="description">{{ category.get_description }}</p>
				</td>
				<td class="posts">{{ category.get_topics|length }}</td>
				<td class="last_post">
					{% if category.get_topics|length > 0 %}
						{% with category.get_topics|first as topic  %}
						<a href="/forum/topics/view/category={{ category.id }}/topic={{ topic.id }}/">{{ topic.title }}</a>
						<span>{{ topic.creation|naturaltime }}</span>
						{% endwith %}
					{% else %}
					{% endif %}
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endblock %}
