{% extends 'askmath/content/lesson/content_view_lesson.html' %}

{% load i18n %}
{% load askmath_tags %}

{% block breadcrumbs %}
	{{ block.super }}
	<li>
		<a href="{% url 'askmath:content_question_view_question' id_discipline=discipline.id id_lesson=lesson.id %}">
			<span class="icon mif-list-numbered"></span> <span>{% trans "Questions" %}</span>
		</a>
	</li>
{% endblock %}

{% block tiles %}
<section>
	{% if lesson.get_questions_visibles|length == 0 %}
	<div class="container">
	{% else %}
	<div class="col-xs-12 col-sm-7 col-md-9 col-lg-9">
		<div class="row">
	{% endif %}
			{% block container-left %}
				<div class="bg-white-opacity">
					<div class="container-fluid">
						<div class="row">
							<div class="meter bg-grayLight">
							  <span class="text-center fg-white" style="width: {{ studentlessonstate.get_percentage_completed }}%">{{ studentlessonstate.get_percentage_completed }}%</span>
							</div>
						</div>
					</div>

					<div class="container-fluid">
						<div class="row">
							<table id="question_status" class="table table-bordered table-condensed text-center no-margin bg-white">
								<tr>
									<td>{% trans "Accumulated Points" %} : {{ studentlessonstate.get_scores }}</td>
									<td>{% trans "Correct Questions" %} : {{ studentlessonstate.get_answered_correct_questions|length }}/{{ lesson.get_questions_visibles|length }}</td>
									<td>{% trans "Skipped Remaining" %} : {{ studentlessonstate.get_remaining_jump }}</td>
								</tr>
							</table>
						</div>
					</div>
					{% if question and lesson_complete == False %}
					<div class="container-fluid">
						<div class="row">
							<p class="lead text-justify">
								{{ question.get_description|safe|linebreaksbr }} <span id="points" class="tag success">{{ question.get_scores }} {% trans "Points" %}</span>
							</p>
							<form id="form-question" action="{% url 'askmath:content_question_answer_question' id_discipline=discipline.id id_lesson=lesson.id id_question=question.id %}" method="POST">
								{% csrf_token %}
								<input type="hidden" name="url_help" value="{% url 'askmath:content_question_help' id_discipline=discipline.id id_lesson=lesson.id id_question=question.id %}" />
								{% for item in question.get_items %}
									<div class="row">
										<label class="input-control radio small-check">
										    <input type="radio"  name="item" value={{ item.id }} required>
										    <span class="check"></span>
										    <span class="caption">{{ item.get_description|safe|linebreaksbr }}</span>
										</label>
									</div>
								{% empty %}
									<p>{% trans "Not Item Found!!!" %}</p>
								{% endfor %}
								<div id="lower-menu"  class="btn-group btn-group-justified">
									<div class="btn-group">
										<button type="submit" class="btn success button"/><span class="mif-checkmark icon"></span> <spam class="hidden-xs">{% trans "Reply" %}</spam></button>
								  	</div>
								  	<div class="btn-group">
								  		<a id="btn-help" class="btn info button"  data-toggle="modal" data-target="#help" {% ifequal question.get_help|length 0 %}disabled{% endifequal %}>
								  			<span class="mif-help icon"></span> <span class="hidden-xs">{% trans "Help" %}</span>
								  		</a>
									</div>
									<div class="btn-group">
									    <a class="btn warning button"   data-toggle="modal" data-target="#jump_question" {% ifequal studentlessonstate.get_remaining_jump  0 %}disabled{% endifequal %}>
									    		<span class="mif-redo icon"></span> <span class="hidden-xs">{% trans "Jump" %}</span>
									    	</a>
									</div>
									<div class="btn-group">
										<a data-toggle="modal" class="btn primary button"  data-target="#skipped_questions" {% if studentlessonstate.get_skipped_questions|length == 0 %}disabled{% endif %}{% if studentlessonstate.get_skipped_questions|length == 1 and question in studentlessonstate.get_skipped_questions  %}disabled{% endif %}>
											<span class="mif-history icon"></span> <span class="hidden-xs">{% trans "Review Jumps" %}</span>
										</a>
									</div>
								</div>
							</form>
						</div>
					</div>
					{% elif not question and lesson_complete %}
					<div class="container-fluid">
						<div class="row">
							<div class="jumbotron">
								<h2 class="align-center">{% trans "Congratulations, complete lesson !!!" %}</h2>
								<br />
								<br />
								<center>
									<a id="btn-starter-lesson" class="btn" href="{% url 'askmath:content_question_reset_lesson' id_discipline=discipline.id id_lesson=lesson.id %}">
										{% trans "Reser Lesson" %}
									</a>
								</center>
							</div>
						</div>
					</div>
					{% elif not question and lesson_complete == False %}
					<div class="container-fluid">
						<div class="row">
							<div class="jumbotron">
								<h2 class="align-center">{% trans "There are no questions for this lesson" %}.</h2>
								<br />
								<br />
							</div>
						</div>
					</div>
					{% else %}
					<div class="container-fluid">
						<div class="row">
							<h1>{% trans "There was an error loading the questions" %}.</h1>
						</div>
					</div>
					{% endif %}
				</div>
			{% endblock %}
		</div>
	</div>
</section>
<aside>
	{% if lesson.get_questions_visibles|length > 0 %}
		<div class="col-xs-12 col-sm-5  col-md-3 col-lg-3">
			{% block container-rigth %}
				<div class="panel width">
					<div class="content">
						<div class="container-fluid">
							<div class="row">
								<h5 class="padding10">
									{% trans "Your level of experience is:" %} <span class="{{ experience_level.get_class_css }}">{{ experience_level.get_level }}</span>
								</h5>
							</div>
							<div class="row">
								<img src="{{ experience_level.get_image_url }}" class="img img-responsive img-avatar">
							</div>
							<div class="row text-center">
								<div class="rating large" data-size="large">
									{% for i in 5|range  %}
										{% if forloop.counter <= studentexperience.stars %}
											<span class="star on"></span>
										{% else %}
											<span class="star off"></span>
										{% endif %}
									
									{% endfor %}
								</div>
							</div>
						</div>	
					</div>
				</div>
			{% endblock %}
		</div>
	{% endif %}
</aside>

{% ifnotequal question.get_help|length 0 %}
<!-- Modal Help -->
<div class="modal fade" id="help" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-xs fg-black">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				<h3 class="modal-title text-center" id="myModalLabel">{% trans "Help Question" %}</h3>
			</div>
			<div class="modal-body">
				<p class="lead">{{ question.get_help|safe|linebreaksbr }}</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="button default" data-dismiss="modal">{% trans "Close" %}</button>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endifnotequal %}

{% if studentlessonstate.get_skipped_questions %}
<!-- Modal kipped Questions -->
<div class="modal fade" id="skipped_questions" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg fg-black">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				<h3 class="modal-title text-center" id="myModalLabel">{% trans "Skipped Questions" %}</h3>
			</div>
			<div class="modal-body">
			<div class="list-group">
				{% for question2 in studentlessonstate.get_skipped_questions %}
					{% if question != question2 %}		
						<a href="{% url 'askmath:content_question_choose_skipped_question' id_discipline=discipline.id id_lesson=lesson.id id_question=question2.id %}" class="list-group-item">{{ question2.get_description|safe|linebreaksbr|truncatewords:"30" }}</a>
					{% endif %}
				{% endfor %}
			</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="button default" data-dismiss="modal">{% trans "Close" %}</button>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endif %}

{% if studentlessonstate.get_remaining_jump > 0 %}
<!-- Modal Jump Question Questions -->
<div class="modal fade" id="jump_question" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-xs fg-black">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title text-center" id="myModalLabel">{% trans "Your Jump is Question?" %}</h3>
			</div>
			<div class="modal-footer">
				<button type="button" class="button primary" data-dismiss="modal">
					{% trans "Not, is error!" %}
				</button>
				<a href="{% url 'askmath:content_question_jump_question' id_discipline=discipline.id id_lesson=lesson.id id_question=question.id %}" class="button success">
				{% trans "Yes, jump!" %}
				</a>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endif %}

{% endblock %}

{% block stylesheet %}
	{% include 'askmath/latex/support.html' %}
{% endblock %}