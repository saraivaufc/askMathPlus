{% extends 'askmath/content/lesson/content_view_lesson.html' %}

{% load i18n %}
{% load askmath_tags %}

{% block breadcrumbs %}
	{{ block.super }}
	<li>
		<a href="/home/content/questions/view_question/discipline={{ discipline.id }}/lesson={{ lesson.id }}/">
			<span class="icon mif-list-numbered"></span> <span>{% trans "Questions" %}</span>
		</a>
	</li>
{% endblock %}

{% block tiles %}
<section>
	{% if lesson.get_questions_visibles|length == 0 %}
	<div class="container">
	{% else %}
	<div class="col-xs-12 col-sm-7 col-md-9 col-lg-9">
		<div class="row">
	{% endif %}
			{% block container-left %}
				<div class="bg-white-opacity">
					<div class="container-fluid">
						<div class="row">
							<div class="meter">
							  <span class="text-center fg-white" style="width: {{ studentlessonstate.get_percentage_completed }}%">{{ studentlessonstate.get_percentage_completed }}%</span>
							</div>
						</div>
					</div>

					<div class="container-fluid">
						<div class="row">
							<table id="question_status" class="table table-bordered table-condensed text-center no-margin">
								<tr>
									<td>{% trans "Scores" %} : {{ studentlessonstate.get_scores }}</td>
									<td>{% trans "Correct Questions" %} : {{ studentlessonstate.get_answered_correct_questions|length }}/{{ lesson.get_questions_visibles|length }}</td>
									<td>{% trans "Skipped Remaining" %} : {{ studentlessonstate.get_remaining_jump }}</td>
								</tr>
							</table>
						</div>
					</div>
					{% if question and lesson_complete == False %}
					<div class="container-fluid">
						<div class="row">
							<p class="lead text-justify">
								{{ question.get_description|safe|linebreaksbr }} <span id="points" class="tag success">{{ question.get_scores }} {% trans "Points" %}</span>
							</p>
							<input type="hidden" name="url_help" value="/home/content/questions/help/discipline={{ discipline.id }}/lesson={{ lesson.id }}/question={{ question.id }}/" />
							<form id="form-question" action="/home/content/questions/answer_question/discipline={{ discipline.id }}/lesson={{ lesson.id }}/question={{ question.id }}/" method="POST">
								{% csrf_token %}
									{% for item in question.get_items %}
										<div class="row">
											<label class="input-control radio small-check">
											    <input type="radio"  name="item" value={{ item.id }}>
											    <span class="check"></span>
											    <span class="caption">{{ item.get_description|safe|linebreaksbr }}</span>
											</label>
										</div>
									{% empty %}
										<p>{% trans "Not Item Found!!!" %}</p>
									{% endfor %}
								<div id="lower-menu"  class="btn-group btn-group-justified">
									<div class="btn-group">
										<button type="submit" class="btn success button"/><span class="mif-checkmark icon"></span> <spam class="hidden-xs">{% trans "Reply" %}</spam></button>
								  	</div>
								  	<div class="btn-group">
								  		<a id="btn-help" class="btn info button"  data-toggle="modal" data-target="#help" {% ifequal question.get_help|length 0 %}disabled{% endifequal %}><span class="mif-help icon"></span> <spam class="hidden-xs">{% trans "Help" %}</spam></a>
									</div>
									<div class="btn-group">
									    <a class="btn warning button"   data-toggle="modal" data-target="#jump_question" {% ifequal studentlessonstate.get_remaining_jump  0 %}disabled{% endifequal %}><span class="mif-redo icon"></span> <spam class="hidden-xs">{% trans "Jump" %}</spam></a>
									</div>
									<div class="btn-group">
										<a data-toggle="modal" class="btn primary button"  data-target="#skipped_questions" {% if studentlessonstate.get_skipped_questions|length == 0 %}disabled{% endif %}{% if studentlessonstate.get_skipped_questions|length == 1 and question in studentlessonstate.get_skipped_questions  %}disabled{% endif %}><span class="mif-history icon"></span> <spam class="hidden-xs">{% trans "Review Jumps" %}</spam></a>
									</div>
								</div>
							</form>
						</div>
					</div>
					{% elif not question and lesson_complete %}
					<div class="container-fluid">
						<div class="row">
							<div class="jumbotron">
								<h2 class="align-center">Parabéns, lição completa!!!</h2>
								<br />
								<br />
								<center>
									<a id="btn-starter-lesson" class="btn" href="/home/content/questions/reset_lesson/discipline={{discipline.id }}/lesson={{ lesson.id }}/">
										{% trans "Reser Lesson" %}
									</a>
								</center>
							</div>
						</div>
					</div>
					{% elif not question and lesson_complete == False %}
					<div class="container-fluid">
						<div class="row">
							<div class="jumbotron">
								<h2 class="align-center">Não existe questões para essa lição.</h2>
								<br />
								<br />
							</div>
						</div>
					</div>
					{% else %}
					<div class="container-fluid">
						<div class="row">
							<h1>Ocorreu um erro ao carregar as peguntas.</h1>
						</div>
					</div>
					{% endif %}

					{% ifnotequal question.get_help|length 0 %}
					<!-- Modal Help -->
					<div class="modal fade" id="help" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog modal-xs fg-black">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
									<h3 class="modal-title text-center" id="myModalLabel">{% trans "Help Question" %}</h3>
								</div>
								<div class="modal-body">
									<p class="lead">{{ question.get_help|safe|linebreaksbr }}</p>
								</div>
								<div class="modal-footer">
									<button type="button" class="button default" data-dismiss="modal">{% trans "Close" %}</button>
								</div>
							</div><!-- /.modal-content -->
						</div><!-- /.modal-dialog -->
					</div><!-- /.modal -->
					{% endifnotequal %}

					{% if studentlessonstate.get_skipped_questions %}
					<!-- Modal kipped Questions -->
					<div class="modal fade" id="skipped_questions" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog modal-lg fg-black">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
									<h3 class="modal-title text-center" id="myModalLabel">{% trans "Skipped Questions" %}</h3>
								</div>
								<div class="modal-body">
								<div class="list-group">
									{% for question2 in studentlessonstate.get_skipped_questions %}
										{% if question != question2 %}		
											<a href="/home/content/questions/choose_skipped_question/discipline={{ discipline.id }}/lesson={{ lesson.id }}/question={{ question2.id }}/" class="list-group-item">{{ question2.get_description|safe|linebreaksbr|truncatewords:"30" }}</a>
										{% endif %}
									{% endfor %}
								</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="button default" data-dismiss="modal">{% trans "Close" %}</button>
								</div>
							</div><!-- /.modal-content -->
						</div><!-- /.modal-dialog -->
					</div><!-- /.modal -->
					{% endif %}
					
					{% if studentlessonstate.get_remaining_jump > 0 %}
					<!-- Modal Jump Question Questions -->
					<div class="modal fade" id="jump_question" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog modal-xs fg-black">
							<div class="modal-content">
								<div class="modal-header">
									<h3 class="modal-title text-center" id="myModalLabel">{% trans "Your Jump is Question?" %}</h3>
								</div>
								<div class="modal-footer">
									<button type="button" class="button primary" data-dismiss="modal">
										{% trans "Not, is error!" %}
									</button>
									<a href="/home/content/questions/jump_question/discipline={{ discipline.id }}/lesson={{ lesson.id }}/question={{ question.id }}/" class="button success">
									{% trans "Yes, jump!" %}
									</a>
								</div>
							</div><!-- /.modal-content -->
						</div><!-- /.modal-dialog -->
					</div><!-- /.modal -->
					{% endif %}
				</div>
			{% endblock %}
		</div>
	</div>
</section>

<aside>
	{% if lesson.get_questions_visibles|length > 0 %}
		<div class="col-xs-12 col-sm-5  col-md-3 col-lg-3">
			{% block container-rigth %}
				<div class="panel width">
					<div class="heading text-center">
						<span class="icon mif-chart-dots text-left"></span>
						<span class="title">{% trans "Progress" %}</span>
					</div>
					<div class="content">
						<div class="container-fluid">
							<div class="row">
								<h5>
									{% trans "Your level of experience is:" %} <span class="{{ experience_level.get_class_css }}">{{ experience_level.get_level }}</span>
								</h5>
							</div>
							<div class="row">
								<img src="{{ experience_level.get_image_url }}" class="img img-responsive img-avatar">
							</div>
							<div class="row">
								<div class="rating large" data-size="large">
									{% for i in 10|range  %}
										{% if forloop.counter <= studentexperience.stars %}
											<span class="star on"></span>
										{% else %}
											<span class="star off"></span>
										{% endif %}
									
									{% endfor %}
								</div>
							</div>
							
							
							{% if studentlessonstate.get_percentage_completed == 100 %}
								<h5>{% trans "Sugestions next lessons:" %}</h5>
								<ul>
								{% for sugestion in lesson.get_sugestions %}
									<li>
										<a class="lead fg-lightTeal" href="/home/content/lessons/view/discipline={{ discipline.id }}/lesson={{ sugestion.id }}/">
										{{ sugestion.get_title }}
										</a>
									</li>
								{% empty %}
									<h5>{% trans "It has no sugestions." %}</h5>
								{% endfor %}
								</ul>
							{% else %}
								<h5>{% trans "Requirements recommended:" %}</h5>
								<ul>
								{% for requirement in lesson.get_requirements %}
									<li>
										<a class="lead  fg-lightTeal" href="/home/content/lessons/view/discipline={{ discipline.id }}/lesson={{ requirement.id }}/">
										{{ requirement }}
										</a>
									</li>
								{% empty %}
									<h5>{% trans "It has no requirements." %}</h5>
								{% endfor %}
								</ul>
							{% endif %}
						</div>	
					</div>
				</div>
			{% endblock %}
		</div>
	{% endif %}
</aside>
{% endblock %}



{% load i18n %}

